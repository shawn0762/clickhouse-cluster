# Docker Engine release 19.03.0+ requiredversion: "3.8"services:  # 分片1的副本1  ck-s01-r01:    image: yandex/clickhouse-server:20.4    volumes:    - ./conf/cluster-config.xml:/etc/clickhouse-server/config.d/cluster-config.xml    - ./conf/s01-r01.xml:/etc/clickhouse-server/config.d/macros.xml    - ./conf/init-db.sql:/docker-entrypoint-initdb.d/init-db.sql    - ./0-zk-check.sh:/docker-entrypoint-initdb.d/0-zk-check.sh#    - /tmp/clickhouse-test/shard_11_data:/var/lib/clickhouse    networks:      clickhouse-default:        aliases:          - ck-s01-r01  # 分片1的副本2  ck-s01-r02:    image: yandex/clickhouse-server:20.4    volumes:    - ./conf/cluster-config.xml:/etc/clickhouse-server/config.d/cluster-config.xml    - ./conf/s01-r02.xml:/etc/clickhouse-server/config.d/macros.xml    - ./conf/init-db.sql:/docker-entrypoint-initdb.d/init-db.sql    - ./0-zk-check.sh:/docker-entrypoint-initdb.d/0-zk-check.sh#    - /tmp/clickhouse-test/shard_12_data:/var/lib/clickhouse    networks:      clickhouse-default:        aliases:          - ck-s01-r02  # 分片2的副本1  ck-s02-r01:    image: yandex/clickhouse-server:20.4    volumes:    - ./conf/cluster-config.xml:/etc/clickhouse-server/config.d/cluster-config.xml    - ./conf/s02-r01.xml:/etc/clickhouse-server/config.d/macros.xml    - ./conf/init-db.sql:/docker-entrypoint-initdb.d/init-db.sql    - ./0-zk-check.sh:/docker-entrypoint-initdb.d/0-zk-check.sh#    - /tmp/clickhouse-test/shard_21_data:/var/lib/clickhouse    networks:      clickhouse-default:        aliases:          - ck-s02-r01  # 分片2的副本2  ck-s02-r02:    image: yandex/clickhouse-server:20.4    volumes:    - ./conf/cluster-config.xml:/etc/clickhouse-server/config.d/cluster-config.xml    - ./conf/s02-r02.xml:/etc/clickhouse-server/config.d/macros.xml    - ./conf/init-db.sql:/docker-entrypoint-initdb.d/init-db.sql    - ./0-zk-check.sh:/docker-entrypoint-initdb.d/0-zk-check.sh#    - /tmp/clickhouse-test/shard_22_data:/var/lib/clickhouse    networks:      clickhouse-default:        aliases:          - ck-s02-r02  # 分片3的副本1  ck-s03-r01:    image: yandex/clickhouse-server:20.4    volumes:    - ./conf/cluster-config.xml:/etc/clickhouse-server/config.d/cluster-config.xml    - ./conf/s03-r01.xml:/etc/clickhouse-server/config.d/macros.xml    - ./conf/init-db.sql:/docker-entrypoint-initdb.d/init-db.sql    - ./0-zk-check.sh:/docker-entrypoint-initdb.d/0-zk-check.sh#    - /tmp/clickhouse-test/shard_31_data:/var/lib/clickhouse    networks:      clickhouse-default:        aliases:          - ck-s03-r01  # 分片3的副本1  ck-s03-r02:    image: yandex/clickhouse-server:20.4    volumes:    - ./conf/cluster-config.xml:/etc/clickhouse-server/config.d/cluster-config.xml    - ./conf/s03-r02.xml:/etc/clickhouse-server/config.d/macros.xml    - ./conf/init-db.sql:/docker-entrypoint-initdb.d/init-db.sql    - ./0-zk-check.sh:/docker-entrypoint-initdb.d/0-zk-check.sh#    - /tmp/clickhouse-test/shard_31_data:/var/lib/clickhouse    networks:      clickhouse-default:        aliases:          - ck-s03-r02  # zk服务器  clickhouse_zookeeper:    image: zookeeper:3.5.8    networks:      clickhouse-default:        aliases:          - zk-servernetworks:  clickhouse-default:    driver: bridge# 宿主机需要创建好相应的挂载目录# /tmp/clickhouse-test/shard_11_data# /tmp/clickhouse-test/shard_12_data# /tmp/clickhouse-test/shard_21_data# /tmp/clickhouse-test/shard_22_data# /tmp/clickhouse-test/shard_31_data# /tmp/clickhouse-test/shard_32_data